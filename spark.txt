sudo apt install openjdk-11-jdk -y

cd ~
wget https://dlcdn.apache.org/spark/spark-3.5.6/spark-3.5.3-bin-hadoop3.tgz
tar -xzf spark-3.5.6-bin-hadoop3.tgz
mv spark-3.5.3-bin-hadoop3 spark

nano ~/.bashrc

export SPARK_HOME=$HOME/spark
export PATH=$PATH:$SPARK_HOME/bin

source ~/.bashrc

spark-shell --version

mkdir ~/spark-input
echo "hello spark hello hadoop hello world" > ~/spark-input/text.txt

spark-shell

val textFile = sc.textFile("spark-input/text.txt")
val counts = textFile.flatMap(line => line.split(" "))
                     .map(word => (word, 1))
                     .reduceByKey(_ + _)
counts.collect().foreach(println)


